#
# Managed by Puppet
#

ScriptAlias /icinga/cgi-bin "<%= scope.lookupvar('icinga::usrlib') %>/icinga/cgi"

<Directory "<%= scope.lookupvar('icinga::params::usrlib') %>/icinga/cgi">
# SSLRequireSSL
  Options ExecCGI
  AllowOverride None
  Order allow,deny
  Allow from all
<% if scope.lookupvar('icinga::use_auth')  %>
  AuthName "Icinga Access"
  AuthType Basic
  AuthzLDAPAuthoritative off
  AuthzLDAPMethod ldap
  AuthzLDAPServer "<%= scope.lookupvar('::ldap_servers').split(',')[0] %>:389"
  AuthzLDAPUserKey "uid"
  AuthzLDAPUserBase "cn=users,cn=accounts,dc=laddersoffice,dc=net"
  AuthzLDAPUserScope "subtree"
  require valid-user
<% end %>
</Directory>

Alias /icinga "/usr/share/icinga/"

<Directory "/usr/share/icinga/">
# SSLRequireSSL
  Options None
  AllowOverride None
  Order allow,deny
  Allow from all
<% if scope.lookupvar('icinga::use_auth')  %>
  AuthName "Icinga Access"
  AuthType Basic
  AuthzLDAPAuthoritative off
  AuthzLDAPMethod ldap
  AuthzLDAPServer "<%= scope.lookupvar('::ldap_servers').split(',')[0] %>:389"
  AuthzLDAPUserKey "uid"
  AuthzLDAPUserBase "cn=users,cn=accounts,dc=laddersoffice,dc=net"
  AuthzLDAPUserScope "subtree"
  require valid-user
<% end %>
</Directory>
